{% extends 'digitalizacion/base.html' %}
{% load static %}

{% block title %}Reportes de Expedientes - Sistema de Digitalización{% endblock %}

{% block extra_css %}
  <!-- Flatpickr CSS -->
  <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/reportes.css' %}">
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');
    * {
      box-sizing: border-box;
    }
    
    /* Variables CSS para temas */
    :root {
      --bg-primary: #20252d;
      --bg-secondary: rgba(26, 26, 26, 0.95);
      --bg-tertiary: rgba(26, 26, 26, 0.95);
      --bg-gradient: linear-gradient(160deg, #2a2f38 10%, #f9f2d6 90%);
      --text-primary: white;
      --text-secondary: rgba(255 255 255 / 0.7);
      --text-muted: rgba(255 255 255 / 0.5);
      --border-color: rgba(255 255 255 / 0.2);
      --border-light: rgba(255 255 255 / 0.1);
      --shadow-color: rgba(0, 0, 0, 0.3);
      --panel-bg: #1a1a1a;
      --panel-border: #333;
      --hover-bg: rgba(255 255 255 / 0.15);
      --active-bg: #121212cc;
      --notification-badge: #ff4757;
    }
    
    [data-theme="light"] {
      --bg-primary: #f8f9fa;
      --bg-secondary: rgba(255, 255, 255, 0.9);
      --bg-tertiary: rgba(248, 249, 250, 0.9);
      --bg-gradient: linear-gradient(160deg, #e9ecef 10%, #f8f9fa 90%);
      --text-primary: #212529;
      --text-secondary: #495057;
      --text-muted: #6c757d;
      --border-color: rgba(0, 0, 0, 0.1);
      --border-light: rgba(0, 0, 0, 0.05);
      --shadow-color: rgba(0, 0, 0, 0.1);
      --panel-bg: #ffffff;
      --panel-border: #dee2e6;
      --hover-bg: rgba(0, 0, 0, 0.05);
      --active-bg: #e9ecef;
      --notification-badge: #dc3545;
    }
    
    body {
      margin: 0;
      background: var(--bg-gradient);
      font-family: 'Roboto', sans-serif;
      color: var(--text-primary);
      display: flex;
      height: 100vh;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .container {
      display: grid;
      grid-template-columns: 280px 1fr;
      grid-template-rows: 100px 1fr;
      width: 100%;
      height: 100vh;
      color: var(--text-primary);
      user-select: none;
      -webkit-user-select: none;
      position: relative;
    }

    .left-panel {
      grid-column: 1 / 2;
      grid-row: 1 / 3;
      background: var(--bg-primary);
      display: flex;
      flex-direction: column;
      padding: 20px 20px 20px 25px;
      gap: 25px;
      position: relative;
      box-shadow: inset -40px 0 60px -30px var(--shadow-color);
      transition: all 0.3s ease;
    }
    
    .logo-text {
      font-weight: 300;
      font-size: 1.4em;
      font-family: 'Roboto', sans-serif;
      user-select: text;
      -webkit-user-select: text;
      line-height: 1.1;
      margin: 0;
      color: var(--text-primary);
    }
    
    .logo-text strong {
      font-weight: 700;
      color: var(--text-primary);
    }
    
    .nav-menu {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
    }
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 12px 15px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--text-primary);
      font-weight: 400;
      font-size: 0.95em;
    }
    
    .nav-item:hover {
      background: var(--hover-bg);
      transform: translateX(5px);
    }
    
    .nav-item.active {
      background: var(--active-bg);
      color: var(--text-primary);
      font-weight: 500;
    }
    
    .nav-item i {
      font-size: 1.2em;
      width: 20px;
      text-align: center;
    }
    
    .main-content {
      grid-column: 2 / 3;
      grid-row: 1 / 3;
      padding: 30px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }
    
    .page-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .page-header h1 {
      font-size: 2.2em;
      font-weight: 600;
      margin: 0;
      color: var(--text-primary);
    }
    
    .page-header i {
      font-size: 1.8em;
      color: var(--text-primary);
    }
    
    .page-description {
      color: var(--text-secondary);
      font-size: 1.1em;
      margin: 0 0 30px 0;
    }
    
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      backdrop-filter: blur(10px);
    }
    
    .theme-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px var(--shadow-color);
    }
    
    .theme-toggle i {
      font-size: 1.2em;
    }
    
    /* Estilos para componentes de reportes */
    .filtros-section {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px var(--shadow-color);
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
    }
    
    .filtros-header {
      margin-bottom: 1.5rem;
    }
    
    .filtros-header h2 {
      color: var(--text-primary);
      font-size: 1.5rem;
      font-weight: 600;
      margin: 0 0 0.5rem 0;
    }
    
    .filtros-header p {
      color: var(--text-secondary);
      margin: 0;
    }
    
    .filtros-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    .filtro-grupo {
      display: flex;
      flex-direction: column;
    }
    
    .filtro-grupo label {
      color: var(--text-primary);
      font-weight: 500;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    .filtro-grupo input,
    .filtro-grupo select {
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 0.9rem;
      transition: all 0.3s ease;
    }
    
    .filtro-grupo input:focus,
    .filtro-grupo select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .botones-filtros {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    
    .btn-filtro {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    
    .btn-filtro.primario {
      background: #3b82f6;
      color: white;
    }
    
    .btn-filtro.primario:hover {
      background: #2563eb;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    .btn-filtro.secundario {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    
    .btn-filtro.secundario:hover {
      background: var(--hover-bg);
      transform: translateY(-2px);
    }
    
    .btn-filtro.exportar {
      background: #10b981;
      color: white;
    }
    
    .btn-filtro.exportar:hover {
      background: #059669;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }
    
    .estadisticas-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .estadistica-card {
      background: var(--bg-secondary);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    
    .estadistica-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px var(--shadow-color);
    }
    
    .estadistica-valor {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }
    
    .estadistica-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .resultados-section {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 8px 32px var(--shadow-color);
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
    }
    
    .resultados-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    
    .resultados-header h3 {
      color: var(--text-primary);
      font-size: 1.3rem;
      font-weight: 600;
      margin: 0;
    }
    
    .resultados-count {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    .tabla-container {
      overflow-x: auto;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }
    
    .tabla-expedientes {
      width: 100%;
      border-collapse: collapse;
      background: var(--bg-primary);
    }
    
    .tabla-expedientes th {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-weight: 600;
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
      font-size: 0.9rem;
    }
    
    .tabla-expedientes td {
      padding: 1rem;
      border-bottom: 1px solid var(--border-light);
      color: var(--text-primary);
      font-size: 0.9rem;
    }
    
    .tabla-expedientes tr:hover {
      background: var(--hover-bg);
    }
    
    .estado-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      text-transform: uppercase;
    }
    
    .estado-pendiente {
      background: #fef3c7;
      color: #92400e;
    }
    
    .estado-en-proceso {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .estado-completado {
      background: #d1fae5;
      color: #065f46;
    }
    
    .estado-rechazado {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .tipo-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }
    
    .paginacion {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      margin-top: 2rem;
    }
    
    .btn-pagina {
      padding: 0.5rem 1rem;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-primary);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }
    
    .btn-pagina:hover {
      background: var(--hover-bg);
    }
    
    .btn-pagina.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    
    .btn-pagina:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .loading-container {
      display: none;
      justify-content: center;
      align-items: center;
      padding: 3rem;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid var(--border-color);
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .sin-resultados {
      display: none;
      text-align: center;
      padding: 3rem;
      color: var(--text-secondary);
    }
    
    .sin-resultados i {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }
    
    .error-container {
      display: none;
      text-align: center;
      padding: 3rem;
      color: #ef4444;
    }
    
    .error-container i {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    
    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
        grid-template-rows: auto 1fr;
      }
      
      .left-panel {
        display: none;
      }
      
      .main-content {
        grid-column: 1 / 2;
        grid-row: 1 / 2;
        padding: 20px;
      }
      
      .filtros-grid {
        grid-template-columns: 1fr;
      }
      
      .botones-filtros {
        flex-direction: column;
      }
      
      .estadisticas-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');
    * {
      box-sizing: border-box;
    }
    
    /* Variables CSS para temas */
    :root {
      --bg-primary: #20252d;
      --bg-secondary: rgba(26, 26, 26, 0.95);
      --bg-tertiary: rgba(26, 26, 26, 0.95);
      --bg-gradient: linear-gradient(160deg, #2a2f38 10%, #f9f2d6 90%);
      --text-primary: white;
      --text-secondary: rgba(255 255 255 / 0.7);
      --text-muted: rgba(255 255 255 / 0.5);
      --border-color: rgba(255 255 255 / 0.2);
      --border-light: rgba(255 255 255 / 0.1);
      --shadow-color: rgba(0, 0, 0, 0.3);
      --panel-bg: #1a1a1a;
      --panel-border: #333;
      --hover-bg: rgba(255 255 255 / 0.15);
      --active-bg: #121212cc;
      --notification-badge: #ff4757;
    }
    
    [data-theme="light"] {
      --bg-primary: #f8f9fa;
      --bg-secondary: rgba(255, 255, 255, 0.9);
      --bg-tertiary: rgba(248, 249, 250, 0.9);
      --bg-gradient: linear-gradient(160deg, #e9ecef 10%, #f8f9fa 90%);
      --text-primary: #212529;
      --text-secondary: #495057;
      --text-muted: #6c757d;
      --border-color: rgba(0, 0, 0, 0.1);
      --border-light: rgba(0, 0, 0, 0.05);
      --shadow-color: rgba(0, 0, 0, 0.1);
      --panel-bg: #ffffff;
      --panel-border: #dee2e6;
      --hover-bg: rgba(0, 0, 0, 0.05);
      --active-bg: #e9ecef;
      --notification-badge: #dc3545;
    }
    
    body {
      margin: 0;
      background: var(--bg-gradient);
      font-family: 'Roboto', sans-serif;
      color: var(--text-primary);
      display: flex;
      height: 100vh;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .container {
      display: grid;
      grid-template-columns: 280px 1fr;
      grid-template-rows: 100px 1fr;
      width: 100%;
      height: 100vh;
      color: var(--text-primary);
      user-select: none;
      -webkit-user-select: none;
      position: relative;
    }

    .left-panel {
      grid-column: 1 / 2;
      grid-row: 1 / 3;
      background: var(--bg-primary);
      display: flex;
      flex-direction: column;
      padding: 20px 20px 20px 25px;
      gap: 25px;
      position: relative;
      box-shadow: inset -40px 0 60px -30px var(--shadow-color);
      transition: all 0.3s ease;
    }
    
    .logo-text {
      font-weight: 300;
      font-size: 1.4em;
      font-family: 'Roboto', sans-serif;
      user-select: text;
      -webkit-user-select: text;
      line-height: 1.1;
      margin: 0;
      color: var(--text-primary);
    }
    
    .logo-text strong {
      font-weight: 700;
      color: var(--text-primary);
    }
    
    .nav-menu {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
    }
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 12px 15px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--text-primary);
      font-weight: 400;
      font-size: 0.95em;
    }
    
    .nav-item:hover {
      background: var(--hover-bg);
      transform: translateX(5px);
    }
    
    .nav-item.active {
      background: var(--active-bg);
      color: var(--text-primary);
      font-weight: 500;
    }
    
    .nav-item i {
      font-size: 1.2em;
      width: 20px;
      text-align: center;
    }
    
    .main-content {
      grid-column: 2 / 3;
      grid-row: 1 / 3;
      padding: 30px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }
    
    .page-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .page-header h1 {
      font-size: 2.2em;
      font-weight: 600;
      margin: 0;
      color: var(--text-primary);
    }
    
    .page-header i {
      font-size: 1.8em;
      color: var(--text-primary);
    }
    
    .page-description {
      color: var(--text-secondary);
      font-size: 1.1em;
      margin: 0 0 30px 0;
    }
    
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      backdrop-filter: blur(10px);
    }
    
    .theme-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px var(--shadow-color);
    }
    
    .theme-toggle i {
      font-size: 1.2em;
    }
    
    /* Estilos para componentes de reportes */
    .filtros-section {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px var(--shadow-color);
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
    }
    
    .filtros-header {
      margin-bottom: 1.5rem;
    }
    
    .filtros-header h2 {
      color: var(--text-primary);
      font-size: 1.5rem;
      font-weight: 600;
      margin: 0 0 0.5rem 0;
    }
    
    .filtros-header p {
      color: var(--text-secondary);
      margin: 0;
    }
    
    .filtros-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    .filtro-grupo {
      display: flex;
      flex-direction: column;
    }
    
    .filtro-grupo label {
      color: var(--text-primary);
      font-weight: 500;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    .filtro-grupo input,
    .filtro-grupo select {
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 0.9rem;
      transition: all 0.3s ease;
    }
    
    .filtro-grupo input:focus,
    .filtro-grupo select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .botones-filtros {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    
    .btn-filtro {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    
    .btn-filtro.primario {
      background: #3b82f6;
      color: white;
    }
    
    .btn-filtro.primario:hover {
      background: #2563eb;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    .btn-filtro.secundario {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    
    .btn-filtro.secundario:hover {
      background: var(--hover-bg);
      transform: translateY(-2px);
    }
    
    .btn-filtro.exportar {
      background: #10b981;
      color: white;
    }
    
    .btn-filtro.exportar:hover {
      background: #059669;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }
    
    .estadisticas-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .estadistica-card {
      background: var(--bg-secondary);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    
    .estadistica-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px var(--shadow-color);
    }
    
    .estadistica-valor {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }
    
    .estadistica-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .resultados-section {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 8px 32px var(--shadow-color);
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
    }
    
    .resultados-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    
    .resultados-header h3 {
      color: var(--text-primary);
      font-size: 1.3rem;
      font-weight: 600;
      margin: 0;
    }
    
    .resultados-count {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    .tabla-container {
      overflow-x: auto;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }
    
    .tabla-expedientes {
      width: 100%;
      border-collapse: collapse;
      background: var(--bg-primary);
    }
    
    .tabla-expedientes th {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      font-weight: 600;
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
      font-size: 0.9rem;
    }
    
    .tabla-expedientes td {
      padding: 1rem;
      border-bottom: 1px solid var(--border-light);
      color: var(--text-primary);
      font-size: 0.9rem;
    }
    
    .tabla-expedientes tr:hover {
      background: var(--hover-bg);
    }
    
    .estado-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      text-transform: uppercase;
    }
    
    .estado-pendiente {
      background: #fef3c7;
      color: #92400e;
    }
    
    .estado-en-proceso {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .estado-completado {
      background: #d1fae5;
      color: #065f46;
    }
    
    .estado-rechazado {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .tipo-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }
    
    .paginacion {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      margin-top: 2rem;
    }
    
    .btn-pagina {
      padding: 0.5rem 1rem;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-primary);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }
    
    .btn-pagina:hover {
      background: var(--hover-bg);
    }
    
    .btn-pagina.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    
    .btn-pagina:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .loading-container {
      display: none;
      justify-content: center;
      align-items: center;
      padding: 3rem;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid var(--border-color);
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .sin-resultados {
      display: none;
      text-align: center;
      padding: 3rem;
      color: var(--text-secondary);
    }
    
    .sin-resultados i {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }
    
    .error-container {
      display: none;
      text-align: center;
      padding: 3rem;
      color: #ef4444;
    }
    
    .error-container i {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    
    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
        grid-template-rows: auto 1fr;
      }
      
      .left-panel {
        display: none;
      }
      
      .main-content {
        grid-column: 1 / 2;
        grid-row: 1 / 2;
        padding: 20px;
      }
      
      .filtros-grid {
        grid-template-columns: 1fr;
      }
      
      .botones-filtros {
        flex-direction: column;
      }
      
      .estadisticas-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Panel izquierdo -->
    <div class="left-panel">
      <div class="logo-text">
        <strong>Sistema de</strong><br>
        Digitalización
                </div>
      
      <nav class="nav-menu">
        <a href="{% url 'digitalizacion:dashboard' %}" class="nav-item">
          <i class="bi bi-house"></i>
          Dashboard
        </a>
        <a href="{% url 'expedientes:lista_expedientes' %}" class="nav-item">
          <i class="bi bi-folder"></i>
          Expedientes
        </a>
        <a href="{% url 'expedientes:seleccionar_tipo' %}" class="nav-item">
          <i class="bi bi-plus-circle"></i>
          Crear Expediente
        </a>
        <a href="{% url 'areas:gestionar' %}" class="nav-item">
          <i class="bi bi-gear"></i>
          Configurar Áreas
        </a>
        <a href="{% url 'digitalizacion:reportes' %}" class="nav-item active">
          <i class="bi bi-bar-chart"></i>
          Reportes
        </a>
        <a href="{% url 'digitalizacion:departamentos' %}" class="nav-item">
          <i class="bi bi-building"></i>
          Departamentos
        </a>
      </nav>
                </div>
    
    <!-- Contenido principal -->
    <div class="main-content">
      <!-- Header de la página -->
      <div class="page-header">
        <i class="bi bi-bar-chart"></i>
        <h1>Reportes de Expedientes</h1>
            </div>
      
      <p class="page-description">
        Selecciona el período de tiempo y filtra los expedientes según tus necesidades
      </p>
      
      <!-- Sección de filtros -->
      <div class="filtros-section">
        <div class="filtros-header">
          <h2>Filtros de Búsqueda</h2>
          <p>Configura los parámetros para obtener los reportes deseados</p>
        </div>
        
        <div class="filtros-grid">
          <div class="filtro-grupo">
            <label for="fecha-inicio">Fecha de Inicio</label>
            <input type="text" id="fecha-inicio" placeholder="Seleccionar fecha">
    </div>

          <div class="filtro-grupo">
            <label for="fecha-fin">Fecha de Fin</label>
            <input type="text" id="fecha-fin" placeholder="Seleccionar fecha">
                </div>
          
          <div class="filtro-grupo">
            <label for="estado">Estado del Expediente</label>
            <select id="estado">
              <option value="">Todos los estados</option>
              <option value="pendiente">Pendiente</option>
              <option value="en_proceso">En Proceso</option>
              <option value="completado">Completado</option>
              <option value="rechazado">Rechazado</option>
            </select>
            </div>
          
          <div class="filtro-grupo">
            <label for="tipo">Tipo de Expediente</label>
            <select id="tipo">
              <option value="">Todos los tipos</option>
              <option value="giro">Giro</option>
              <option value="pago">Solicitud de Pago</option>
              <option value="requisicion">Requisición</option>
            </select>
                    </div>
                    </div>
        
        <div class="botones-filtros">
          <button class="btn-filtro primario" onclick="aplicarFiltros()">
            <i class="bi bi-search"></i>
            Aplicar Filtros
                        </button>
          <button class="btn-filtro secundario" onclick="limpiarFiltros()">
            <i class="bi bi-arrow-clockwise"></i>
            Limpiar Filtros
          </button>
          <button class="btn-filtro exportar" onclick="exportarExcel()">
            <i class="bi bi-download"></i>
            Exportar a Excel
                        </button>
        </div>
    </div>

      <!-- Estadísticas -->
      <div class="estadisticas-grid">
        <div class="estadistica-card">
          <div class="estadistica-valor" id="total-expedientes">0</div>
          <div class="estadistica-label">Total de Expedientes</div>
            </div>
        <div class="estadistica-card">
          <div class="estadistica-valor" id="expedientes-pendientes">0</div>
          <div class="estadistica-label">Pendientes</div>
        </div>
        <div class="estadistica-card">
          <div class="estadistica-valor" id="expedientes-proceso">0</div>
          <div class="estadistica-label">En Proceso</div>
            </div>
        <div class="estadistica-card">
          <div class="estadistica-valor" id="expedientes-completados">0</div>
          <div class="estadistica-label">Completados</div>
        </div>
    </div>

      <!-- Resultados -->
      <div class="resultados-section">
        <div class="resultados-header">
          <h3>Resultados de la Búsqueda</h3>
          <div class="resultados-count" id="resultados-count">0 expedientes encontrados</div>
    </div>

        <!-- Loading -->
        <div class="loading-container" id="loading-container">
          <div class="spinner"></div>
          <p style="margin-top: 1rem; color: var(--text-secondary);">Buscando expedientes...</p>
    </div>

        <!-- Sin resultados -->
        <div class="sin-resultados" id="sin-resultados">
          <i class="bi bi-search"></i>
          <h4>No se encontraron expedientes</h4>
          <p>Intenta ajustar los filtros de búsqueda</p>
        </div>

        <!-- Mensaje de error -->
        <div class="error-container" id="error-container">
          <i class="bi bi-exclamation-triangle"></i>
          <h4>Error al cargar datos</h4>
          <p id="error-message">Ha ocurrido un error inesperado</p>
          <button class="btn-filtro primario" onclick="aplicarFiltros()" style="margin-top: 1rem;">
            <i class="bi bi-arrow-clockwise"></i>
            Reintentar
                        </button>
                    </div>
        
        <!-- Tabla de resultados -->
        <div class="tabla-container" id="tabla-container" style="display: none;">
          <table class="tabla-expedientes">
                            <thead>
                                <tr>
                <th>Número</th>
                <th>Tipo</th>
                <th>Subtipo</th>
                                    <th>Estado</th>
                <th>Fecha Creación</th>
                <th>Departamento</th>
                <th>Solicitante</th>
                                </tr>
                            </thead>
            <tbody id="tabla-body">
                                <!-- Los datos se cargarán dinámicamente -->
                            </tbody>
                        </table>
          
          <!-- Paginación -->
          <div class="paginacion" id="paginacion">
            <!-- Los controles de paginación se generarán dinámicamente -->
                    </div>
                    </div>
                </div>
            </div>
        </div>

  <!-- Token CSRF para las peticiones AJAX -->
  {% csrf_token %}
  
  <!-- Botón de cambio de tema -->
  <button class="theme-toggle" onclick="toggleTheme()" title="Cambiar tema">
    <i class="bi bi-sun-fill" id="theme-icon"></i>
                        </button>
 
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  
  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
  
  <!-- XLSX.js para exportar a Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  
<script>
    // Variables globales
    let expedientesData = [];
    let paginaActual = 1;
    const expedientesPorPagina = 10;
    
    // Inicialización cuando se carga la página
    document.addEventListener('DOMContentLoaded', function() {
      inicializarFiltros();
    });
    
    // Inicializar Flatpickr para los campos de fecha
    function inicializarFiltros() {
      const hoy = new Date();
      const haceUnMes = new Date(hoy.getFullYear(), hoy.getMonth() - 1, hoy.getDate());
      
      // Formatear fechas en formato ISO (YYYY-MM-DD) para el valor interno
      // Usar zona horaria local para evitar problemas de fecha
      const fechaInicioISO = formatearFechaISO(haceUnMes);
      const fechaFinISO = formatearFechaISO(hoy);
      
      // Inicializar Flatpickr para fecha inicio
      const fechaInicioInput = document.getElementById('fecha-inicio');
      const flatpickrInicio = flatpickr("#fecha-inicio", {
        locale: "es",
        dateFormat: "Y-m-d",
        allowInput: true,
        placeholder: "Seleccionar fecha",
        altInput: true,
        altFormat: "d M Y",
        defaultDate: fechaInicioISO,
        onChange: function(selectedDates, dateStr, instance) {
          console.log('Fecha inicio seleccionada:', dateStr);
        }
      });
      
      // Inicializar Flatpickr para fecha fin
      const fechaFinInput = document.getElementById('fecha-fin');
      const flatpickrFin = flatpickr("#fecha-fin", {
        locale: "es",
        dateFormat: "Y-m-d",
        allowInput: true,
        placeholder: "Seleccionar fecha",
        altInput: true,
        altFormat: "d M Y",
        defaultDate: fechaFinISO,
        onChange: function(selectedDates, dateStr, instance) {
          console.log('Fecha fin seleccionada:', dateStr);
        }
      });
      
      // Establecer valores iniciales
      fechaInicioInput.value = fechaInicioISO;
      fechaFinInput.value = fechaFinISO;
      
      // Cargar datos iniciales después de inicializar Flatpickr
      setTimeout(() => {
        cargarDatosIniciales();
      }, 100);
    }
    
    // Cargar datos iniciales
    function cargarDatosIniciales() {
      aplicarFiltros();
    }
    
    // Aplicar filtros y buscar expedientes
    function aplicarFiltros() {
      paginaActual = 1;
      buscarExpedientes();
    }
    
    // Limpiar filtros
    function limpiarFiltros() {
      const hoy = new Date();
      const haceUnMes = new Date(hoy.getFullYear(), hoy.getMonth() - 1, hoy.getDate());
      
      // Formatear fechas en formato ISO (YYYY-MM-DD)
      // Usar zona horaria local para evitar problemas de fecha
      const fechaInicioISO = haceUnMes.toLocaleDateString('en-CA'); // Formato YYYY-MM-DD
      const fechaFinISO = hoy.toLocaleDateString('en-CA'); // Formato YYYY-MM-DD
      
      // Limpiar otros filtros
      document.getElementById('estado').value = '';
      document.getElementById('tipo').value = '';
      
      // Obtener instancias de Flatpickr
      const fechaInicioInput = document.getElementById('fecha-inicio');
      const fechaFinInput = document.getElementById('fecha-fin');
      
      // Actualizar Flatpickr y valores
      if (fechaInicioInput._flatpickr) {
        fechaInicioInput._flatpickr.setDate(fechaInicioISO);
      }
      if (fechaFinInput._flatpickr) {
        fechaFinInput._flatpickr.setDate(fechaFinISO);
      }
      
      // Establecer valores en los campos
      fechaInicioInput.value = fechaInicioISO;
      fechaFinInput.value = fechaFinISO;
      
      // Aplicar filtros limpios
      aplicarFiltros();
    }
    
    // Buscar expedientes con filtros
    function buscarExpedientes() {
      // Obtener valores reales de Flatpickr
      const fechaInicioInput = document.getElementById('fecha-inicio');
      const fechaFinInput = document.getElementById('fecha-fin');
      
      let fechaInicio = fechaInicioInput.value;
      let fechaFin = fechaFinInput.value;
      
      // Si Flatpickr está inicializado, obtener el valor real
      if (fechaInicioInput._flatpickr) {
        const fechaInicioReal = fechaInicioInput._flatpickr.selectedDates[0];
        if (fechaInicioReal) {
          // Usar toLocaleDateString para mantener zona horaria local
          fechaInicio = fechaInicioReal.toLocaleDateString('en-CA'); // Formato YYYY-MM-DD
        }
      }
      
      if (fechaFinInput._flatpickr) {
        const fechaFinReal = fechaFinInput._flatpickr.selectedDates[0];
        if (fechaFinReal) {
          // Usar toLocaleDateString para mantener zona horaria local
          fechaFin = fechaFinReal.toLocaleDateString('en-CA'); // Formato YYYY-MM-DD
        }
      }
      
      const estado = document.getElementById('estado').value;
      const tipo = document.getElementById('tipo').value;
      
      mostrarLoading();
      
      // Crear objeto con los filtros
      const filtros = {
        fecha_inicio: fechaInicio,
        fecha_fin: fechaFin,
        estado: estado,
        tipo: tipo
      };
      
      console.log('Filtros aplicados:', filtros);
      console.log('Fecha inicio:', fechaInicio);
      console.log('Fecha fin:', fechaFin);
      
      // Llamada AJAX real al endpoint
      fetch('{% url "digitalizacion:obtener_expedientes_filtrados" %}', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        },
        body: JSON.stringify(filtros)
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          expedientesData = data.expedientes;
          ocultarLoading();
          mostrarResultados();
          actualizarEstadisticas();
          renderizarTabla();
          renderizarPaginacion();
        } else {
          console.error('Error al obtener expedientes:', data.error);
          ocultarLoading();
          mostrarError(data.error || 'Error desconocido al obtener expedientes');
        }
      })
      .catch(error => {
        console.error('Error en la petición:', error);
        ocultarLoading();
        
        // Si hay error de conexión, usar datos de ejemplo como fallback
        if (error.name === 'TypeError' || error.message.includes('fetch')) {
          console.log('Usando datos de ejemplo como fallback');
          const expedientes = generarExpedientesEjemplo();
          expedientesData = expedientes;
          mostrarResultados();
          actualizarEstadisticas();
          renderizarTabla();
          renderizarPaginacion();
        } else {
          mostrarError('Error de conexión: ' + error.message);
        }
      });
    }
    
    // Generar expedientes de ejemplo (reemplazar con datos reales)
    function generarExpedientesEjemplo() {
      const expedientes = [];
      const tipos = ['giro', 'pago', 'requisicion'];
      const subtipos = ['ferreteria', 'limpieza', 'oficina'];
      const estados = ['pendiente', 'en_proceso', 'completado', 'rechazado'];
      const departamentos = ['Servicios Públicos', 'Mantenimiento', 'Administración'];
      const solicitantes = ['Juan Pérez', 'María García', 'Carlos López', 'Ana Martínez'];
      
      for (let i = 1; i <= 45; i++) {
        const fecha = new Date();
        fecha.setDate(fecha.getDate() - Math.floor(Math.random() * 30));
        
        expedientes.push({
          id: i,
          numero: `EXP-${String(i).padStart(4, '0')}`,
          tipo: tipos[Math.floor(Math.random() * tipos.length)],
          subtipo: subtipos[Math.floor(Math.random() * subtipos.length)],
          estado: estados[Math.floor(Math.random() * estados.length)],
          fecha_creacion: fecha,
          departamento: departamentos[Math.floor(Math.random() * departamentos.length)],
          solicitante: solicitantes[Math.floor(Math.random() * solicitantes.length)]
        });
      }
      
      return expedientes;
    }
    
    // Mostrar loading
    function mostrarLoading() {
      document.getElementById('loading-container').style.display = 'flex';
      document.getElementById('tabla-container').style.display = 'none';
      document.getElementById('sin-resultados').style.display = 'none';
      document.getElementById('error-container').style.display = 'none';
    }
    
    // Ocultar loading
    function ocultarLoading() {
      document.getElementById('loading-container').style.display = 'none';
    }
    
    // Mostrar resultados
    function mostrarResultados() {
      if (expedientesData.length > 0) {
        document.getElementById('tabla-container').style.display = 'block';
        document.getElementById('sin-resultados').style.display = 'none';
        document.getElementById('error-container').style.display = 'none';
        } else {
        mostrarSinResultados();
      }
    }
    
    // Mostrar mensaje de sin resultados
    function mostrarSinResultados() {
      document.getElementById('tabla-container').style.display = 'none';
      document.getElementById('sin-resultados').style.display = 'block';
      document.getElementById('error-container').style.display = 'none';
    }
    
    // Ocultar resultados
    function ocultarResultados() {
      document.getElementById('tabla-container').style.display = 'none';
      document.getElementById('sin-resultados').style.display = 'none';
      document.getElementById('error-container').style.display = 'none';
    }
    
    // Mostrar error
    function mostrarError(mensaje) {
      document.getElementById('error-message').textContent = mensaje;
      document.getElementById('error-container').style.display = 'block';
      document.getElementById('tabla-container').style.display = 'none';
      document.getElementById('sin-resultados').style.display = 'none';
    }
    
    // Actualizar estadísticas
    function actualizarEstadisticas() {
      const total = expedientesData.length;
      const pendientes = expedientesData.filter(e => e.estado === 'pendiente').length;
      const enProceso = expedientesData.filter(e => e.estado === 'en_proceso').length;
      const completados = expedientesData.filter(e => e.estado === 'completado').length;
      
      document.getElementById('total-expedientes').textContent = total;
      document.getElementById('expedientes-pendientes').textContent = pendientes;
      document.getElementById('expedientes-proceso').textContent = enProceso;
      document.getElementById('expedientes-completados').textContent = completados;
      
      document.getElementById('resultados-count').textContent = `${total} expedientes encontrados`;
    }
    
    // Renderizar tabla
    function renderizarTabla() {
      const inicio = (paginaActual - 1) * expedientesPorPagina;
      const fin = inicio + expedientesPorPagina;
      const expedientesPagina = expedientesData.slice(inicio, fin);
      
      const tbody = document.getElementById('tabla-body');
      tbody.innerHTML = '';
      
      expedientesPagina.forEach(expediente => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${expediente.numero}</td>
          <td><span class="tipo-badge">${formatearTipo(expediente.tipo)}</span></td>
          <td>${expediente.subtipo}</td>
          <td><span class="estado-badge estado-${expediente.estado}">${formatearEstado(expediente.estado)}</span></td>
          <td>${formatearFecha(expediente.fecha_creacion)}</td>
          <td>${expediente.departamento}</td>
          <td>${expediente.solicitante}</td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Renderizar paginación
    function renderizarPaginacion() {
      const totalPaginas = Math.ceil(expedientesData.length / expedientesPorPagina);
      const paginacion = document.getElementById('paginacion');
      
      if (totalPaginas <= 1) {
        paginacion.style.display = 'none';
        return;
      }
      
      paginacion.style.display = 'flex';
      paginacion.innerHTML = '';
      
      // Botón anterior
      const btnAnterior = document.createElement('button');
      btnAnterior.className = 'btn-pagina';
      btnAnterior.textContent = 'Anterior';
      btnAnterior.disabled = paginaActual === 1;
      btnAnterior.onclick = () => cambiarPagina(paginaActual - 1);
      paginacion.appendChild(btnAnterior);
      
      // Números de página
      for (let i = 1; i <= totalPaginas; i++) {
        if (i === 1 || i === totalPaginas || (i >= paginaActual - 2 && i <= paginaActual + 2)) {
          const btnPagina = document.createElement('button');
          btnPagina.className = `btn-pagina ${i === paginaActual ? 'active' : ''}`;
          btnPagina.textContent = i;
          btnPagina.onclick = () => cambiarPagina(i);
          paginacion.appendChild(btnPagina);
        } else if (i === paginaActual - 3 || i === paginaActual + 3) {
          const span = document.createElement('span');
          span.textContent = '...';
          span.style.color = 'var(--text-secondary)';
          span.style.padding = '0.5rem';
          paginacion.appendChild(span);
        }
      }
      
      // Botón siguiente
      const btnSiguiente = document.createElement('button');
      btnSiguiente.className = 'btn-pagina';
      btnSiguiente.textContent = 'Siguiente';
      btnSiguiente.onclick = () => cambiarPagina(paginaActual + 1);
      paginacion.appendChild(btnSiguiente);
    }
    
    // Cambiar página
    function cambiarPagina(pagina) {
      paginaActual = pagina;
      renderizarTabla();
      renderizarPaginacion();
    }
    
    // Formatear tipo de expediente
    function formatearTipo(tipo) {
      const tipos = {
        'giro': 'Giro',
        'pago': 'Solicitud de Pago',
        'requisicion': 'Requisición'
      };
      return tipos[tipo] || tipo;
    }
    
    // Formatear estado
    function formatearEstado(estado) {
      const estados = {
        'pendiente': 'Pendiente',
        'en_proceso': 'En Proceso',
        'completado': 'Completado',
        'rechazado': 'Rechazado'
      };
      return estados[estado] || estado;
    }
    
    // Formatear fecha
    function formatearFecha(fecha) {
      if (typeof fecha === 'string') {
        fecha = new Date(fecha);
      }
      return fecha.toLocaleDateString('es-ES', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
    }
    
    // Exportar a Excel
    function exportarExcel() {
      if (expedientesData.length === 0) {
        alert('No hay datos para exportar');
        return;
      }
      
      // Preparar datos para Excel
      const datosExcel = expedientesData.map(exp => ({
        'Número': exp.numero,
        'Tipo': formatearTipo(exp.tipo),
        'Subtipo': exp.subtipo,
        'Estado': formatearEstado(exp.estado),
        'Fecha Creación': formatearFecha(exp.fecha_creacion),
        'Departamento': exp.departamento,
        'Solicitante': exp.solicitante
      }));
      
      // Crear workbook y worksheet
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(datosExcel);
      
      // Agregar worksheet al workbook
      XLSX.utils.book_append_sheet(wb, ws, 'Expedientes');
      
      // Generar archivo y descargar
      const nombreArchivo = `reporte_expedientes_${formatearFecha(new Date()).replace(/\//g, '-')}.xlsx`;
      XLSX.writeFile(wb, nombreArchivo);
    }
    
    // Cambiar tema
    function toggleTheme() {
      const html = document.documentElement;
      const themeIcon = document.getElementById('theme-icon');
      
      if (html.getAttribute('data-theme') === 'light') {
        html.setAttribute('data-theme', 'dark');
        themeIcon.className = 'bi bi-sun-fill';
        localStorage.setItem('theme', 'dark');
    } else {
        html.setAttribute('data-theme', 'light');
        themeIcon.className = 'bi bi-moon-fill';
        localStorage.setItem('theme', 'light');
      }
    }
    
    // Cargar tema guardado
    function cargarTemaGuardado() {
      const temaGuardado = localStorage.getItem('theme');
      const html = document.documentElement;
      const themeIcon = document.getElementById('theme-icon');
      
      if (temaGuardado) {
        html.setAttribute('data-theme', temaGuardado);
        if (temaGuardado === 'light') {
          themeIcon.className = 'bi bi-moon-fill';
        }
      }
    }
    
        // Función auxiliar para formatear fechas en formato YYYY-MM-DD usando zona horaria local
    function formatearFechaISO(fecha) {
      return fecha.toLocaleDateString('en-CA'); // Formato YYYY-MM-DD
    }
    
    // Cargar tema al iniciar
    cargarTemaGuardado();
  </script>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
